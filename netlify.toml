# =========================
# Netlify Configuration
# =========================

[build]
  base = "app"
  publish = "web/dist"
  command = "npm run build:all"

[functions]
  directory = "functions/dist"
  node_bundler = "esbuild"

# =========================
# Local Development
# =========================

[dev]
  command = "npm --prefix web run dev"
  targetPort = 5173
  port = 8888
  publish = "web/dist"
  functions = "functions/dist"

# =========================
# API Gateway Routing
# =========================

# Route /api/* to Netlify function named "api"
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/api/:splat"
  status = 200
  force = true

# =========================
# SPA Fallback
# =========================

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
